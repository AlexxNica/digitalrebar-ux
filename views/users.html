<!--
users view
-->
<div ng-switch="hasUsers">
  <div ng-switch-when="-1">
    <div layout="row" layout-sm="column" layout-align="space-around">
      <md-progress-circular md-mode="indeterminate"></md-progress-circular>
    </div>
  </div>

  <div ng-switch-when="0">
    Error Loading Users
  </div>

  <div ng-switch-when="1">
    <md-card flex='100' ng-repeat="user in userList | orderBy:'username'">

      <md-toolbar ng-click="expand[user.id]=!expand[user.id]" md-ink-ripple>
        <div class="md-toolbar-tools">
          <h2 flex>
            {{user.username}}
          </h2>
          <h2>
            {{tenants[user.tenant_id].name || user.tenant_id}}
          </h2>
          <span>
            <md-button class='md-icon-button'>
              <md-icon ng-hide="expand[user.id]">expand_more</md-icon>
              <md-icon ng-show="expand[user.id]">expand_less</md-icon>
            </md-button>
          </span>
        </div>
      </md-toolbar>
      <div ng-slide-down="expand[user.id]" lazy-render duration="0.25">
        <section layout-padding style='overflow-x: auto;'>
          <table>
            <tr>
              <td class='label'>
                Email
              </td>
              <td>
                {{user.email}}
              </td>
            </tr>
            <tr>
              <td class='label'>
                Tenant
              </td>
              <td>
                {{tenants[user.tenant_id].name || user.tenant_id}}
              </td>
            </tr>
            <tr ng-repeat='(tenant_id, tenant) in user.caps'>
              <td class='label' valign="top">
                Capabilities ({{tenants[tenant_id].name || tenant_id}})
              </td>
              <td>
                <md-chips ng-model='tenant.caps' readonly='true'>
                  <md-chip-template style='font-family: monospace;'>
                    {{capabilities[$chip].name}}
                  </md-chip-template>
                </md-chips>
              </td>
            </tr>
          </table>
        </section>

        <md-card-actions layout="row" layout-align="end center">
          <md-button class='md-icon-button' ng-click='createUserPrompt($event, user)'>
            <md-icon>mode_edit</md-icon>
            <md-tooltip>Edit</md-tooltip>
          </md-button>

          <!-- Right side of toolbar -->
          <md-card-icon-actions layout-align='end center'>
            <md-button class='md-icon-button' ng-click='deleteUser(user.name)'>
              <md-icon>delete</md-icon>
              <md-tooltip>Destroy</md-tooltip>
            </md-button>
          </md-card-icon-actions>
        </md-card-actions>
      </div>
    </md-card>
  </div>

</div>

<!-- Floating action button at the bottom right of the screen -->
<div>
  <md-button class='md-fab md-accent md-fab-bottom-right' ng-click='createUserPrompt($event)'>
    <md-icon>add</md-icon>
    <md-tooltip>Create User</md-tooltip>
  </md-button>
</div>
